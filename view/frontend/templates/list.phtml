<?php
/**
 * @category   Bsc
 * @package    Bsc_DrugTest
 * @author     web@bodyscience.com.au
 * @copyright  This file was generated by using Module Creator(http://code.vky.co.in/magento-2-module-creator/) provided by VKY <viky.031290@gmail.com>
 * @license    http://opensource.org/licenses/osl-3.0.php  Open Software License (OSL 3.0)
 */
?>
<?php
$_objectManager = \Magento\Framework\App\ObjectManager::getInstance(); //instance of\Magento\Framework\App\ObjectManager
$storeManager = $_objectManager->get('Magento\Store\Model\StoreManagerInterface');
$currentStore = $storeManager->getStore();
?>
<?php
echo $this->getLayout()
    ->createBlock('Magento\Cms\Block\Block')
    ->setBlockId('drug_test_content')
    ->toHtml();
?>

<?php
echo $this->getLayout()
    ->createBlock('Magento\Cms\Block\Block')
    ->setBlockId('drug_test_faq')
    ->toHtml();
?>
<?php
echo $this->getLayout()
    ->createBlock('Magento\Cms\Block\Block')
    ->setBlockId('drug_test_hasta')
    ->toHtml();
?>

<?php $collection = $block->getDrugTestCollection(); ?>
<?php if ($collection->count() > 0): ?>
    <h3>Test Results</h3>
    <p>Click below to download the certificate</p>
    <table class="data table" id="drugtest-data-table">
        <caption class="table-caption">Bsc Drug Test Data</caption>
        <thead>
        <tr>
            <th scope="col" class="col product">Product</th>
            <th scope="col" class="col flavour">Flavour</th>
            <th scope="col" class="col batch">Batch</th>
            <th scope="col" class="col expiry">Expiry/BB</th>
            <th scope="col" class="col certificate_date">Certificate Date</th>
            <th scope="col" class="col certify_by">Certify By</th>
            <th scope="col" class="col testing_schedule">Testing Schedule</th>


            <th scope="col" class="col actions">Action</th>
        </tr>
        </thead>
        <tbody>
        <?php foreach ($collection as $key => $data): ?>
            <tr>
                <td data-th="Product" class="col product"><?php echo $data->getProduct(); ?></td>
                <td data-th="Flavour" class="col flavour"><?php echo $data->getFlavour(); ?></td>
                <td data-th="Batch" class="col batch"><?php echo $data->getBatch(); ?></td>
                <td data-th="Expiry" class="col expiry"><?php echo $data->getExpiry(); ?></td>
                <td data-th="Certificate Date"
                    class="col certificate_date"><?php echo $data->getCertificateDate(); ?></td>
                <td data-th="Certificate Date"
                    class="col certify_by"><?php echo $data->getCertifyBy(); ?></td>
                <td data-th="Testing Schedule"
                    class="col testing_schedule"><?php echo $data->getTestingSchedule(); ?></td>


                <td data-th="Actions" class="col actions">
                    <?php $id = ($data->getDrugTestId()) ? $data->getDrugTestId() : $data['drugtest_id']; ?>
                    <!-- "$data->getTesting13Id()" was not working when I generated Vky_Testing13 module. That's why I had to place above line. -->
                    <a href="<?php echo $currentStore->getBaseUrl(\Magento\Framework\UrlInterface::URL_TYPE_MEDIA); ?><?php echo $data->getImage(); ?>"
                       class="action view" target="_blank">
                        <span>View</span>
                    </a>
                </td>
            </tr>
        <?php endforeach; ?>
        </tbody>
    </table>

<?php else: ?>
    <h2>We couldn't find any records</h2>
<?php endif; ?>

<?php
echo $this->getLayout()
    ->createBlock('Magento\Cms\Block\Block')
    ->setBlockId('drug_test_antidoping')
    ->toHtml();
?>
